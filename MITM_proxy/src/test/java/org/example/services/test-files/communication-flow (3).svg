<svg viewBox="0 0 800 500" xmlns="http://www.w3.org/2000/svg">
  <!-- Background and title -->
  <rect width="800" height="500" fill="#f8f9fa" />
  <text x="400" y="30" font-family="Arial" font-size="20" text-anchor="middle" font-weight="bold">Agent-Observer Communication Flow</text>

  <!-- Entities -->
  <rect x="100" y="70" width="150" height="60" fill="#e6f2ff" stroke="#0066cc" stroke-width="2" rx="5" />
  <text x="175" y="105" font-family="Arial" font-size="16" text-anchor="middle" font-weight="bold">Agent</text>
  
  <rect x="550" y="70" width="150" height="60" fill="#e6ffee" stroke="#009933" stroke-width="2" rx="5" />
  <text x="625" y="105" font-family="Arial" font-size="16" text-anchor="middle" font-weight="bold">Observer</text>
  
  <!-- Lifelines -->
  <line x1="175" y1="130" x2="175" y2="470" stroke="#0066cc" stroke-width="2" stroke-dasharray="5,5" />
  <line x1="625" y1="130" x2="625" y2="470" stroke="#009933" stroke-width="2" stroke-dasharray="5,5" />
  
  <!-- Communication messages -->
  <!-- 1. Heartbeat -->
  <line x1="175" y1="160" x2="625" y2="160" stroke="#666666" stroke-width="1.5" marker-end="url(#arrowhead)" />
  <text x="400" y="155" font-family="Arial" font-size="12" text-anchor="middle">1. Heartbeat &amp; Status (periodic)</text>
  
  <!-- 2. File Operation Stats -->
  <line x1="175" y1="200" x2="625" y2="200" stroke="#666666" stroke-width="1.5" marker-end="url(#arrowhead)" />
  <text x="400" y="195" font-family="Arial" font-size="12" text-anchor="middle">2. File Operation Statistics</text>
  
  <!-- 3. Suspicious Activity -->
  <line x1="175" y1="240" x2="625" y2="240" stroke="#cc0000" stroke-width="2" marker-end="url(#arrowhead)" />
  <text x="400" y="235" font-family="Arial" font-size="12" text-anchor="middle" font-weight="bold">3. Suspicious Activity Alert</text>
  <rect x="635" y="240" width="20" height="60" fill="#e6ffee" stroke="#009933" stroke-width="1" />
  <text x="695" y="270" font-family="Arial" font-size="12" text-anchor="start">4. Threat Evaluation</text>
  
  <!-- 5. Authorization -->
  <line x1="625" y1="320" x2="175" y2="320" stroke="#cc0000" stroke-width="2" marker-end="url(#arrowhead)" />
  <text x="400" y="315" font-family="Arial" font-size="12" text-anchor="middle" font-weight="bold">5. Action Authorization Token (signed)</text>
  
  <!-- 6. Execution Report -->
  <rect x="165" y="320" width="20" height="40" fill="#e6f2ff" stroke="#0066cc" stroke-width="1" />
  <text x="125" y="340" font-family="Arial" font-size="12" text-anchor="end">Process Termination</text>
  <line x1="175" y1="380" x2="625" y2="380" stroke="#666666" stroke-width="1.5" marker-end="url(#arrowhead)" />
  <text x="400" y="375" font-family="Arial" font-size="12" text-anchor="middle">6. Action Execution Report</text>
  
  <!-- 7. Configuration Updates -->
  <line x1="625" y1="420" x2="175" y2="420" stroke="#666666" stroke-width="1.5" marker-end="url(#arrowhead)" />
  <text x="400" y="415" font-family="Arial" font-size="12" text-anchor="middle">7. Configuration Updates</text>
  
  <!-- Arrow definition -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#000" />
    </marker>
  </defs>

  <!-- Legend -->
  <rect x="580" y="440" width="20" height="5" fill="none" stroke="#666666" stroke-width="1.5" />
  <text x="605" y="445" font-family="Arial" font-size="10" text-anchor="start">Regular Messages</text>
  
  <rect x="580" y="460" width="20" height="5" fill="none" stroke="#cc0000" stroke-width="2" />
  <text x="605" y="465" font-family="Arial" font-size="10" text-anchor="start">Critical/Security Messages</text>
</svg>
